import os
import sys


def CreateFile(run):

    # dirs = os.system("ls /sps/atlas/groups/photons/PhotonD3PD/data/p1196/*_p1029_p1196_p1197* | grep  "+str(run) )
    # print dirs

    f = os.popen("ls /sps/atlas/groups/photons/PhotonD3PD/data/p1196/*"+str(run)+ "*_p1029_p1196_p1197*/*root* ")
    files_list = []
    for i in f.readlines():
        if i.endswith("\n"):
            line = i[:-1]
        files_list.append(line)
    # print files_list
    # print len(files_list),"root files for this run"
    if len(files_list)==0:
        print "Please check run ",run
        return
    else:
        outfile_name = "input_data_run"+str(run)+".txt"
        outfile = file(outfile_name,"w")
        nfiles = 0
        for i in files_list:
            nfiles = nfiles+1
            if nfiles < len(files_list):
                outfile.write(i+",")
            else:    
                outfile.write(i)
        outfile.close()
        return


if __name__ == "__main__":

    runnumber = [200841,200842,200863,200913,200926,200965,200967,200982,200987,201006,201052,201113,201120,201138,201190,201257,201269,201280,201289,201489,201494,201555,201556,202660,202668,202712,202740,202798,202965,202991,203027,203169,203191,203195,203228,203256,203258,203277,203335,203336,203353,203432,203454,203456,203523,203524,203602,203605,203636,203680,203719,203739,203745,203760,203779,203792,203875,203876,203934,204025,204026,204071,204073,204134,204153,204158,204240,204265,204416,204442,204474,204564,204633,204668,204726,204763,204769,204772,204796,204853,204857,204910,204932,204954,204955,204976,205010,205016,205017,205055,205071,205112,205113,206368,206369,206409,206497,206573,206614,206955,206962,206971,207044,207046,207221,207262,207304,207332,207397,207447,207490,207528,207531,207532,207582,207589,207620,207664,207696,207749,207772,207800,207809,207845,207864,207865,207929,207931,207934,207975,207982,208123,208126,208179,208184,208189,208258,208261,208354,208485,208631,208642,208662,208705,208717,208720,208780,208781,208811,208870,208930,208931,208970,208982,209024,209025,209074,209084,209109,209161,209183,209214,209254,209265,209269,209353,209381,209550,209580,209608,209628,209629,209736,209776,209787,209812,209864,209866,209899,209980,209995,210302,210308,211620,211670,211697,211772,211787,211867,211902,211937,212034,212103,212142]

    for i in runnumber:
        CreateFile(i)
